# 2.2.12 Cycle 12: Finish line

## Design

In [Cycle 8](2.2.8-cycle-8.md) I forgot to add the finish line. This will appear at the end of the racing track. When the player collides with the finish line, their car will stop accelerating and eventually come to a stop. Additionally, the stopwatch created in [Cycle 11](2.2.11-cycle-11.md) will stop counting anymore seconds and text saying "FINISH!" will appear for a few seconds in the centre of the screen. In a later cycle, I will add a level-specific leaderboard that shows after finish, which will display how each player performed in the specific level and their overall standing.&#x20;

### Objectives

* [x] During generation of the worlds, add finish line on the road near the end.
* [x] During rendering of the world, if the block is a chest or finish line, add a tag so the sprite can be identified.
* [x] When the player crosses the finish line, end the stopwatch, stop acceleration, and display text "FINISH!" for a few seconds.

### Usability Features

### Key Variables

| Variable Name         | Use                                                                        |
| --------------------- | -------------------------------------------------------------------------- |
| handleCollisions(car) | Function to run code after the player's car collides with certain sprites. |
| acceleration          | Increase in speed of the car while moving forward.                         |

### Pseudocode

{% code title="server.js" %}
```
func World(main, road, prop):
    // loops
    
        if (y == 20):
            name = "road"
        
        worlds.push({
            name: name
            // other info
        })
```
{% endcode %}

{% code title="sprites/car.js" %}
```
func handleCollisions(car):
    car.onCollide("finish", func(): 
        car.acceleration = 0
        
        clearTimeout(s)
        
        finishText = addText("FINISH!", center())
        
        setTimeout(destroy(finishText), 5000)
    )
```
{% endcode %}

{% code title="scenes/level.js" %}
```
socket.on('get numbers' func (data):
    // other stuff
    
    handleCollisions(myCar)
)
```
{% endcode %}

## Development

### Outcome



### Challenges



## Testing

Evidence for testing

### Tests

<table><thead><tr><th width="95">Test</th><th width="158">Instructions</th><th width="171">What I expect</th><th width="174">What actually happens</th><th>Pass/Fail</th></tr></thead><tbody><tr><td>1</td><td>During world generation, add finish line on the road near end.</td><td>Finish line shows on the road near the end of the world.</td><td>As expected</td><td>Pass</td></tr><tr><td>2</td><td>If player collides with finish line, print to console.</td><td>When the player crosses the finish,  a message is printed to console.</td><td>As expected</td><td>Pass</td></tr><tr><td>3</td><td>Stop accelerating after player crosses finish line.</td><td>Car gradually decelerates until it stops after crossing finish.</td><td>As expected</td><td>Pass</td></tr><tr><td>4</td><td>If the player collides with the finish line, end the stopwatch.</td><td>Stopwatch stops counting after the player crosses finish.</td><td>Uncaught ReferenceError: s is not defined</td><td>Fail</td></tr><tr><td>5</td><td>Use a custom window event to end the stopwatch.</td><td>Stopwatch stops counting after the player crosses finish.</td><td>As expected</td><td>Pass</td></tr><tr><td>6</td><td>If the player collides with the finish line, display finish text in the centre for five seconds.</td><td>Large text "FINISH!" shows for five seconds after crossing finish.</td><td>As expected</td><td>Pass</td></tr></tbody></table>

### Evidence

<figure><img src="../.gitbook/assets/image (1).png" alt=""><figcaption><p>Test 1: Finish line near the end of the world.</p></figcaption></figure>

{% embed url="https://youtu.be/IBq4dKUC18I" %}
Test 2: Message outputted to browser console when the player crosses the finish line
{% endembed %}

{% embed url="https://youtu.be/MSvJSJ9IEHI" %}
Test 3: Player stops accelerating and starts decelerating after crossing finish
{% endembed %}

{% embed url="https://youtu.be/Fn5xYPkuLH0" %}
Test 4: Game crashes after crossing finish with error "Uncaught ReferenceError: s is not defined"
{% endembed %}

{% embed url="https://youtu.be/cP2ZMIFgKlc" %}
Test 5: Stopwatch stops counting after player crosses the finish line
{% endembed %}

{% embed url="https://youtu.be/wXIa2e84xqs" %}
Test 6: "FINISH!" text for five seconds after the player crosses the finish line
{% endembed %}
