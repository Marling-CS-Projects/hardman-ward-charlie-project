# 2.2.15 Cycle 15: Getting powerups from chest

## Design

In this cycle, I will be writing the code to detect when the player collides with a chest. I will take into account factors such as the player's position in the race implemented in [Cycle 13](2.2.13-cycle-13.md) and the amount of health the player has setup in [Cycle 14](2.2.15-cycle-14.md). This means for example if the player is far behind they are more likely to get a speed potion and if they are low health they are more likely to get a regeneration or healing potion.

### Objectives

* [x] When a player collides with the chest, delete the chest from the map.
* [x] Pick a random power-up from a list.
* [x] Certain factors increase the likelihood of certain power-ups being selected.
* [x] Display the power-up inside a square container in the left of the screen.

### Usability Features

### Key Variables

| Variable Name | Use |
| ------------- | --- |
|               |     |

### Pseudocode

```
```

## Development

### Outcome

On completion of this cycle, I have written the code for obtaining power-ups from colliding with a chest. This is important as power-ups serve as a way to distract and injure other players and to boost the player themselves such as in speed or health points. Additionally, I have made it so if the player is far behind or at low health they are likely to get a power-up that helps solve this problem.

Firstly, I added to the handleCollisions function that I setup in [Cycle 12](2.2.12-cycle-12.md) to detect collisions between the player's car and any chest.

### Challenges

During this cycle I encountered an error twice.&#x20;

## Testing

Evidence for testing

### Tests

<table><thead><tr><th width="95">Test</th><th width="158">Instructions</th><th width="171">What I expect</th><th width="174">What actually happens</th><th>Pass/Fail</th></tr></thead><tbody><tr><td>1</td><td>On player collision with chest, delete chest from world.</td><td>When the player collides with the chest, it disappears for all players.</td><td>Chests disappear but with a lot of lag.</td><td>Pass</td></tr><tr><td>2</td><td>Do not delete the chest if the index is -1.</td><td>No lag when the player collides with a chest.</td><td>As expected</td><td>Pass</td></tr><tr><td>3</td><td>Random select power-up with certain conditions.</td><td>Player given power-up after colliding with chest.</td><td>Uncaught TypeError: Cannot read properties of undefined (reading 'powerup')</td><td>Fail</td></tr><tr><td>4</td><td>Define powerup property of car as null.</td><td>Player given power-up after colliding with chest.</td><td>Same error as before.</td><td>Fail</td></tr><tr><td>5</td><td>Render power-up sprite after selecting power-up.</td><td>Player given power-up after colliding with chest.</td><td>Power-up slightly outside of the container.</td><td>Pass</td></tr><tr><td>6</td><td>Move power-up sprite slightly to the right.</td><td>Power-up fits within the square container.</td><td>As expected</td><td>Pass</td></tr></tbody></table>

### Evidence

{% embed url="https://youtu.be/vYY3DCil-lM" %}
Test 1: Chest disappears upon player collision but there is lag
{% endembed %}

{% embed url="https://youtu.be/KPSoDwQoSvU" %}
Test 2: Chest disappears upon player collision, no more lag
{% endembed %}

<figure><img src="../.gitbook/assets/image (2) (1) (1) (1).png" alt=""><figcaption><p>Test 3 and 4: Uncaught TypeError: Cannot read properties of undefined (reading 'powerup')</p></figcaption></figure>

{% embed url="https://youtu.be/BW2xkeKXwtU" %}
Test 5: Power-up slightly out of container
{% endembed %}

{% embed url="https://youtu.be/qapfmVOb688" %}
Test 6: Power-up now fits within container
{% endembed %}
